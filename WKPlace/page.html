<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Vulnerability</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs/themes/prism-tomorrow.css">
<script src="https://cdn.jsdelivr.net/npm/prismjs/prism.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-markup.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-javascript.min.js"></script>

<style>
:root {
  --bg:#000;--fg:#fff;--muted:rgba(255,255,255,.6);
  --glass:rgba(255,255,255,.06);--border:rgba(255,255,255,.12);
}
body {
  margin:0;background:var(--bg);color:var(--fg);
  font-family:Inter,-apple-system,BlinkMacSystemFont,"SF Pro Text",sans-serif;
  line-height:1.6;
}
main {max-width:900px;margin:0 auto;padding:64px 24px;}
.back {color:var(--muted);text-decoration:none;font-size:14px;}
.card {
  margin-top:32px;padding:32px;border-radius:20px;
  background:var(--glass);backdrop-filter:blur(12px);
  border:1px solid var(--border);
}
pre {
  border-radius:14px;
  border:1px solid var(--border);
}
.try {
  display:inline-block;margin-top:16px;padding:10px 16px;
  border-radius:12px;border:1px solid var(--border);
  color:var(--fg);text-decoration:none;
}
.try:hover {border-color:rgba(255,255,255,.3);}
</style>
</head>

<body>
<main>
<a class="back" href="index.html">← Back</a>
<article class="card" id="content">Loading…</article>
</main>

<script>
const id=new URLSearchParams(location.search).get("id");

fetch("src/data/vulns.json")
  .then(r=>r.json())
  .then(vulns=>{
    const v=vulns.find(x=>x.id===id);
    const c=document.getElementById("content");
    if(!v){c.textContent="Not found";return;}

    let pocBlock='<p>PoC not available.</p>';

    if(v.poc){
      fetch(v.poc)
        .then(r=>r.text())
        .then(code=>{
          pocBlock=`
            <pre><code class="language-markup">${escapeHtml(code)}</code></pre>
            <a class="try" href="${v.poc}" target="_blank" rel="noopener">Try now</a>
          `;
          render(pocBlock);
        });
    }

    function render(poc){
      c.innerHTML=`
        <h1>${v.id}</h1>
        <p class="muted">${v.impact}</p>
        <h2>Description</h2>
        <p>${v.description}</p>
        <h2>Proof of Concept</h2>
        ${poc}
      `;
      Prism.highlightAll();
    }

    if(!v.poc) render(pocBlock);
  });

function escapeHtml(s){
  return s.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");
}
</script>
</body>
</html>
